{"version":3,"file":"model-viewer-element.js","sources":["../src/model-viewer-element.js"],"sourcesContent":["import * as THREE from 'three';\nimport ModelLoader from './ModelLoader.js';\n\n// model-viewer element\n// Loads and displays a 3D model\n\n// Events\n// model-change: Fires when a model is going to load\n// model-loaded: Fires when all the geometry has been fully loaded\n// error: Fires when there's a problem loading the model\nclass ModelViewer extends HTMLElement {\n\n\tstatic get observedAttributes() {\n\n\t\treturn [ 'src', 'display-shadow', 'ambient-color', 'show-grid' ];\n\n\t}\n\n\tget loadingManager() {\n\n\t\treturn this._loadingManager = this._loadingManager || new THREE.LoadingManager();\n\n\t}\n\n\tget modelLoader() {\n\n\t\treturn this._modelLoader = this._modelLoader || new ModelLoader( this.loadingManager );\n\n\t}\n\n\tget src() {\n\n\t\treturn this.getAttribute( 'src' ) || '';\n\n\t}\n\tset src( val ) {\n\n\t\tthis.setAttribute( 'src', val );\n\n\t}\n\n\tget displayShadow() {\n\n\t\treturn this.hasAttribute( 'display-shadow' ) || false;\n\n\t}\n\tset displayShadow( val ) {\n\n\t\tval = !! val;\n\t\tval ? this.setAttribute( 'display-shadow', '' ) : this.removeAttribute( 'display-shadow' );\n\n\t}\n\n\tget ambientColor() {\n\n\t\treturn this.getAttribute( 'ambient-color' ) || '#455A64';\n\n\t}\n\tset ambientColor( val ) {\n\n\t\tval ? this.setAttribute( 'ambient-color', val ) : this.removeAttribute( 'ambient-color' );\n\n\t}\n\n\tget showGrid() {\n\n\t\treturn this.hasAttribute( 'show-grid' ) || false;\n\n\t}\n\tset showGrid( val ) {\n\n\t\tval ? this.setAttribute( 'show-grid', true ) : this.removeAttribute( 'show-grid' );\n\n\t}\n\n\tget autoRedraw() {\n\n\t\treturn this.hasAttribute( 'auto-redraw' ) || false;\n\n\t}\n\tset autoRedraw( val ) {\n\n\t\tval ? this.setAttribute( 'auto-redraw', true ) : this.removeAttribute( 'auto-redraw' );\n\n\t}\n\n\t/* Lifecycle Functions */\n\tconstructor() {\n\n\t\tsuper();\n\n\t\t// Scene setup\n\t\tconst scene = new THREE.Scene();\n\t\tconst camera = new THREE.PerspectiveCamera( 75, 1, 0.1, 1000 );\n\t\tcamera.position.z = 10;\n\n\t\tconst ambientLight = new THREE.HemisphereLight( this.ambientColor, '#000' );\n\t\tambientLight.groundColor.lerp( ambientLight.color, 0.5 );\n\t\tambientLight.intensity = 0.5;\n\t\tambientLight.position.set( 0, 1, 0 );\n\t\tscene.add( ambientLight );\n\n\t\t// Light setup\n\t\tconst dirLight = new THREE.DirectionalLight( 0xffffff );\n\t\tdirLight.position.set( 4, 10, 4 );\n\t\tdirLight.shadow.bias = - 0.0001;\n\t\tdirLight.shadow.mapSize.width = 2048;\n\t\tdirLight.shadow.mapSize.height = 2048;\n\t\tdirLight.castShadow = true;\n\t\tscene.add( dirLight );\n\t\tscene.add( dirLight.target );\n\n\t\t// Containers setup\n\t\tconst scaleContainer = new THREE.Object3D();\n\t\tscene.add( scaleContainer );\n\n\t\tconst rotator = new THREE.Object3D();\n\t\tscaleContainer.add( rotator );\n\n\t\tconst plane = new THREE.Mesh(\n\t\t\tnew THREE.PlaneGeometry(),\n\t\t\tnew THREE.ShadowMaterial( { side: THREE.DoubleSide, transparent: true, opacity: 0.25 } )\n\t\t);\n\t\tplane.rotation.set( - Math.PI / 2, 0, 0 );\n\t\tplane.scale.multiplyScalar( 20 );\n\t\tplane.receiveShadow = true;\n\t\tscaleContainer.add( plane );\n\n\t\tconst gridHelper = new THREE.GridHelper( 10, 10, 0xffffff, 0xeeeeee );\n\t\tgridHelper.material.transparent = true;\n\t\tgridHelper.material.opacity = 0.6;\n\t\tgridHelper.visible = false;\n\t\tscaleContainer.add( gridHelper );\n\n\t\t// Renderer setup\n\t\tconst renderer = new THREE.WebGLRenderer( { antialias: true, alpha: true } );\n\t\trenderer.setClearColor( 0xffffff );\n\t\trenderer.setClearAlpha( 0 );\n\t\trenderer.shadowMap.enabled = true;\n\n\t\t// enable gamma correction before display\n\t\trenderer.gammaOutput = true;\n\n\t\t// Controls setup\n\t\tconst controls = new THREE.OrbitControls( camera, renderer.domElement );\n\t\tcontrols.rotateSpeed = 2.0;\n\t\tcontrols.zoomSpeed = 5;\n\t\tcontrols.panSpeed = 2;\n\t\tcontrols.enableZoom = true;\n\t\tcontrols.enablePan = false;\n\t\tcontrols.enableDamping = false;\n\t\tcontrols.maxDistance = 50;\n\t\tcontrols.minDistance = 0.25;\n\t\tcontrols.addEventListener( 'change', () => this._dirty = true );\n\n\t\tthis.renderer = renderer;\n\t\tthis.camera = camera;\n\t\tthis.controls = controls;\n\n\t\tthis.scene = scene;\n\t\tthis.rotator = rotator;\n\t\tthis.scaleContainer = scaleContainer;\n\t\tthis.ambientLight = ambientLight;\n\t\tthis.directionalLight = dirLight;\n\n\t\tthis.plane = plane;\n\t\tthis.gridHelper = gridHelper;\n\n\t\tthis._model = null;\n\t\tthis._requestId = 0;\n\n\t\tthis.loadingManager.onLoad = () => this._dirty = true;\n\n\t\tconst _renderLoop = () => {\n\n\t\t\tif ( this.parentNode ) {\n\n\t\t\t\tthis._refresh();\n\t\t\t\tthis.controls.update();\n\t\t\t\tif ( this._dirty || this.autoRedraw ) {\n\n\t\t\t\t\tthis.directionalLight.castShadow = this.displayShadow;\n\n\t\t\t\t\tif ( this._model && this.displayShadow ) {\n\n\t\t\t\t\t\t// Update the shadow camera rendering bounds to encapsulate the\n\t\t\t\t\t\t// model. We use the bounding sphere of the bounding box for\n\t\t\t\t\t\t// simplicity -- this could be a tighter fit.\n\t\t\t\t\t\tconst bbox = new THREE.Box3().setFromObject( this._model );\n\t\t\t\t\t\tconst center = bbox.getCenter( new THREE.Vector3() );\n\t\t\t\t\t\tconst sphere = bbox.getBoundingSphere( new THREE.Sphere() );\n\t\t\t\t\t\tconst minmax = sphere.radius;\n\t\t\t\t\t\tconst cam = this.directionalLight.shadow.camera;\n\t\t\t\t\t\tcam.left = cam.bottom = - minmax;\n\t\t\t\t\t\tcam.right = cam.top = minmax;\n\n\t\t\t\t\t\t// Update the camera to focus on the center of the model so the\n\t\t\t\t\t\t// shadow can encapsulate it\n\t\t\t\t\t\tconst dirLight = this.directionalLight;\n\t\t\t\t\t\tconst offset = dirLight.position.clone().sub( dirLight.target.position );\n\t\t\t\t\t\tdirLight.target.position.copy( center );\n\t\t\t\t\t\tdirLight.position.copy( center ).add( offset );\n\t\t\t\t\t\tcam.updateProjectionMatrix();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.renderer.render( scene, camera );\n\t\t\t\t\tthis._dirty = false;\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._renderLoopId = requestAnimationFrame( _renderLoop );\n\n\t\t};\n\t\t_renderLoop();\n\n\t}\n\n\tconnectedCallback() {\n\n\t\t// Add our initialize styles for the element if they haven't\n\t\t// been added yet\n\t\tif ( ! this.constructor._styletag ) {\n\n\t\t\tconst styletag = document.createElement( 'style' );\n\t\t\tstyletag.innerHTML =\n            `\n                ${this.tagName} { display: block; }\n                ${this.tagName} canvas {\n                    width: 100%;\n                    height: 100%;\n                }\n            `;\n\t\t\tdocument.head.appendChild( styletag );\n\t\t\tthis.constructor._styletag = styletag;\n\n\t\t}\n\n\t\t// add the renderer\n\t\tif ( this.childElementCount === 0 ) {\n\n\t\t\tthis.appendChild( this.renderer.domElement );\n\n\t\t}\n\n\t}\n\n\tdisconnectedCallback() {\n\n\t\tcancelAnimationFrame( this._renderLoopId );\n\n\t}\n\n\tattributeChangedCallback( attr, oldval, newval ) {\n\n\t\tthis._dirty = true;\n\n\t\tswitch ( attr ) {\n\n\t\t\tcase 'src': {\n\n\t\t\t\tthis._loadModel( this.src );\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tcase 'ambient-color': {\n\n\t\t\t\tthis.ambientLight.color.set( this.ambientColor );\n\t\t\t\tthis.ambientLight.groundColor.set( '#000' ).lerp( this.ambientLight.color, 0.5 );\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tcase 'show-grid': {\n\n\t\t\t\tthis.gridHelper.visible = this.showGrid;\n\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/* Public API */\n\tredraw() {\n\n\t\tthis._dirty = true;\n\n\t}\n\n\t/* Private Functions */\n\t_refresh() {\n\n\t\tconst r = this.renderer;\n\t\tconst w = this.clientWidth;\n\t\tconst h = this.clientHeight;\n\t\tconst currsize = r.getSize();\n\n\t\tif ( currsize.width != w || currsize.height != h ) {\n\n\t\t\tthis._dirty = true;\n\n\t\t\tr.setPixelRatio( window.devicePixelRatio );\n\t\t\tr.setSize( w, h, false );\n\n\t\t\tthis.camera.aspect = w / h;\n\t\t\tthis.camera.updateProjectionMatrix();\n\n\t\t}\n\n\t}\n\n\t_loadModel( src ) {\n\n\t\tif ( this._prevsrc === src ) return;\n\t\tthis._prevsrc = src;\n\n\t\tif ( this._model ) {\n\n\t\t\tthis._model.parent.remove( this._model );\n\t\t\tthis._model = null;\n\t\t\tthis._dirty = true;\n\n\t\t}\n\n\t\tif ( src ) {\n\n\t\t\tthis.dispatchEvent( new CustomEvent( 'model-change', { bubbles: true, cancelable: true, composed: true, detail: src } ) );\n\n\t\t\t// Keep track of this request and make\n\t\t\t// sure it doesn't get overwritten by\n\t\t\t// a subsequent one\n\t\t\tthis._requestId ++;\n\t\t\tconst requestId = this._requestId;\n\n\t\t\tthis.modelLoader\n\t\t\t\t.load( src, res => {\n\n\t\t\t\t\tif ( this._requestId !== requestId ) return;\n\n\t\t\t\t\tthis._addModel( res.model );\n\t\t\t\t\tthis.dispatchEvent( new CustomEvent( 'model-loaded', { bubbles: true, cancelable: true, composed: true } ) );\n\n\t\t\t\t}, null, err => {\n\n\t\t\t\t\tthis.dispatchEvent( new CustomEvent( 'error', { bubbles: true, cancelable: true, composed: true, detail: err } ) );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t_addModel( obj ) {\n\n\t\tconst rotator = this.rotator;\n\t\tconst scaleContainer = this.scaleContainer;\n\t\tconst plane = this.plane;\n\t\tconst gridHelper = this.gridHelper;\n\n\t\tthis._model = obj;\n\n\t\t// Get the bounds of the model and scale and set appropriately\n\t\tobj.updateMatrixWorld( true );\n\t\tconst box = new THREE.Box3().expandByObject( obj );\n\t\tconst sphere = box.getBoundingSphere( new THREE.Sphere() );\n\t\tconst s = 3 / sphere.radius;\n\n\t\trotator.add( obj );\n\t\trotator.rotation.set( 0, 0, 0 );\n\t\tobj.position\n\t\t\t.copy( sphere.center )\n\t\t\t.negate();\n\n\t\tscaleContainer.scale.set( 1, 1, 1 ).multiplyScalar( s );\n\n\t\t// add an additional tiny offset so the shadow plane won't\n\t\t// z-fight with the bottom of the model\n\t\tconst offset = Math.abs( box.max.y - box.min.y ) * 1e-5;\n\t\tplane.position.y = obj.position.y + box.min.y - offset;\n\t\tplane\n\t\t\t.scale\n\t\t\t.set( 1, 1, 1 )\n\t\t\t.multiplyScalar( 100 / s );\n\n\t\tgridHelper.position.copy( plane.position );\n\t\tgridHelper.position.y -= offset;\n\n\t\t// make sure the obj will cast shadows\n\t\tobj.traverse( c => {\n\n\t\t\tc.castShadow = true;\n\t\t\tc.receiveShadow = true;\n\n\t\t\tif ( c.isMesh ) {\n\n\t\t\t\tif ( c.material ) {\n\n\t\t\t\t\tconst mats = Array.isArray( c.material ) ? c.material : [ c.material ];\n\t\t\t\t\tmats.forEach( ( m, i ) => {\n\n\t\t\t\t\t\tif ( m instanceof THREE.MeshBasicMaterial ) {\n\n\t\t\t\t\t\t\tconst mat = new THREE.MeshPhongMaterial( { color: 0x888888 } );\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tc.geometry.isBufferGeometry && 'color' in c.geometry.attributes\n\t\t\t\t\t\t\t\t|| c.geometry.isGeometry\n\t\t\t\t\t\t\t) {\n\n\t\t\t\t\t\t\t\tmat.vertexColors = THREE.VertexColors;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ( c.geometry.isBufferGeometry && ! ( 'normal' in c.geometry.attributes ) ) {\n\n\t\t\t\t\t\t\t\tc.geometry.computeVertexNormals();\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmat.map = m.map;\n\n\t\t\t\t\t\t\tmats[ i ] = mat;\n\t\t\t\t\t\t\tm = mat;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// TODO: Lambert materials don't handle shadows well, so\n\t\t\t\t\t\t// we replace them here. Remove this once the THREE bug is fixed\n\t\t\t\t\t\t// Mentioned in https://github.com/mrdoob/three.js/issues/8238\n\t\t\t\t\t\tif ( m instanceof THREE.MeshLambertMaterial ) {\n\n\t\t\t\t\t\t\t// Can't use the `copy` function because the phong material expects\n\t\t\t\t\t\t\t// a specular color\n\t\t\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/14401\n\t\t\t\t\t\t\tconst mat = new THREE.MeshPhongMaterial();\n\t\t\t\t\t\t\tObject.keys( m )\n\t\t\t\t\t\t\t\t.filter( key => key in mat && m[ key ] && key != 'type' )\n\t\t\t\t\t\t\t\t.forEach( key => mat[ key ] = m[ key ] );\n\n\t\t\t\t\t\t\tmats[ i ] = mat;\n\t\t\t\t\t\t\tm = mat;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( m.map ) {\n\n\t\t\t\t\t\t\t// The texture's color space is assumed to be\n\t\t\t\t\t\t\t// in sRGB, though most of the THREE loaders assume\n\t\t\t\t\t\t\t// a Linear color space.\n\t\t\t\t\t\t\tm.map.encoding = THREE.GammaEncoding;\n\t\t\t\t\t\t\tm.needsUpdate = true;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tm.shadowSide = THREE.DoubleSide;\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( Array.isArray( c.material ) ) c.material = mats;\n\t\t\t\t\telse c.material = mats[ 0 ];\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} );\n\n\t\tthis._dirty = true;\n\n\t}\n\n}\n\nwindow.ModelViewer = ModelViewer;\n"],"names":["THREE.LoadingManager","THREE.Scene","THREE.PerspectiveCamera","THREE.HemisphereLight","THREE.DirectionalLight","THREE.Object3D","THREE.Mesh","THREE.PlaneGeometry","THREE.ShadowMaterial","THREE.DoubleSide","THREE.GridHelper","THREE.WebGLRenderer","THREE.OrbitControls","THREE.Box3","THREE.Vector3","THREE.Sphere","THREE.MeshBasicMaterial","THREE.MeshPhongMaterial","THREE.VertexColors","THREE.MeshLambertMaterial","THREE.GammaEncoding"],"mappings":"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"}